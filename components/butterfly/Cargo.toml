[package]
name = "habitat_butterfly"
version = "0.1.0"
edition = "2018"
authors = ["The Habitat Maintainers <humans@habitat.sh>"]
build = "build.rs"
workspace = "../../"

[[bin]]
name = "butterfly"
path = "src/main.rs"
doc = false

[dependencies]
byteorder = "*"
bytes = "*"
env_logger = "*"
habitat_core = { path = "../core" }
habitat_common = { path = "../common" }
log = "*"
lazy_static = "*"
prometheus = "*"
parking_lot = "*"
# Must use fork due to this issue https://github.com/danburkert/prost/issues/242
prost = { git = "https://github.com/dingelish/prost" }
# Must use fork due to this issue https://github.com/danburkert/prost/issues/242
prost-derive = { git = "https://github.com/dingelish/prost" }
rand = "*"
serde = { version = "*", features = ["rc"] }
serde_derive = "*"
serde_json = "*"
tempfile = "*"
time = "*"
threadpool = "*"
toml = { version = "*", default-features = false }
uuid = { version = "*", features = ["v4"] }
zmq = { git = "https://github.com/habitat-sh/rust-zmq", branch = "v0.8-symlinks-removed" }

[dev-dependencies]
mktemp = "*"

[build-dependencies]
heck = "*"
pkg-config = "*"
# Must use fork due to this issue https://github.com/danburkert/prost/issues/242
prost = { git = "https://github.com/dingelish/prost" }
# Must use fork due to this issue https://github.com/danburkert/prost/issues/242
prost-build = { git = "https://github.com/dingelish/prost" }
tempfile = "*"

[features]
default = ["protocols"]
protocols = []
lock_as_rwlock = ["habitat_common/lock_as_rwlock"]
lock_as_mutex = ["habitat_common/lock_as_mutex"]
deadlock_detection = ["parking_lot/nightly", "parking_lot/deadlock_detection", "habitat_common/deadlock_detection"]
